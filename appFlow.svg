<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="1567" height="840" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[Note left of A: A knows the Public key of CA
A -> Certification Authority : Register with CA
Note right of B: B knows the Public key of CA
B -> Certification Authority : Register with CA
Note left of A: A knows the ID and port of B
A -> Certification Authority : get certificate of B
Certification Authority -> A : Certificate of B
Note right of B: B knows the ID and port of A
B -> Certification Authority : get certificate of A
Certification Authority -> B : Certificate of A
A -> Certification Authority : Verify validity of B's Certificate
Certification Authority -> A : Validity of certificate (True, if valid. False, otherwise)
B -> Certification Authority : Verify validity of A's Certificate
Certification Authority -> B : Validity of certificate (True, if valid. False, otherwise)
Note left of A : If certificate of B is valid
Note right of B : If certificate of A is valid
A -> B : Sends encrypted message "Hello"
B -> A : Sends encrypted message "ACK"]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="261.015625" y="20" width="30" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="272.015625" y="43" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="271.015625">A</tspan></text></g><g class="actor"><rect x="261.015625" y="784" width="30" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="272.015625" y="807" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="271.015625">A</tspan></text></g><line x1="276.015625" x2="276.015625" y1="56" y2="784" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="658.0234375" y="20" width="206.015625" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="669.0234375" y="43" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="668.0234375">Certification Authority</tspan></text></g><g class="actor"><rect x="658.0234375" y="784" width="206.015625" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="669.0234375" y="807" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="668.0234375">Certification Authority</tspan></text></g><line x1="761.03125" x2="761.03125" y1="56" y2="784" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="1231.046875" y="20" width="30" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1242.046875" y="43" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1241.046875">B</tspan></text></g><g class="actor"><rect x="1231.046875" y="784" width="30" height="36" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1242.046875" y="807" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1241.046875">B</tspan></text></g><line x1="1246.046875" x2="1246.046875" y1="56" y2="784" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="note"><rect x="20" y="76" width="236.015625" height="26" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="26" y="94" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="25">A knows the Public key of CA</tspan></text></g><g class="signal"><text x="454.515625" y="132" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="453.515625">Register with CA</tspan></text><line x1="276.015625" x2="761.03125" y1="138" y2="138" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="1266.046875" y="158" width="236.015625" height="26" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1272.046875" y="176" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1271.046875">B knows the Public key of CA</tspan></text></g><g class="signal"><text x="939.53125" y="214" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="938.53125">Register with CA</tspan></text><line x1="1246.046875" x2="761.03125" y1="220" y2="220" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="20" y="240" width="236.015625" height="26" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="26" y="258" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="25">A knows the ID and port of B</tspan></text></g><g class="signal"><text x="438.515625" y="296" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="437.515625">get certificate of B</tspan></text><line x1="276.015625" x2="761.03125" y1="302" y2="302" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="454.515625" y="332" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="453.515625">Certificate of B</tspan></text><line x1="761.03125" x2="276.015625" y1="338" y2="338" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="1266.046875" y="358" width="236.015625" height="26" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1272.046875" y="376" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1271.046875">B knows the ID and port of A</tspan></text></g><g class="signal"><text x="923.53125" y="414" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="922.53125">get certificate of A</tspan></text><line x1="1246.046875" x2="761.03125" y1="420" y2="420" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="939.53125" y="450" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="938.53125">Certificate of A</tspan></text><line x1="761.03125" x2="1246.046875" y1="456" y2="456" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="382.515625" y="486" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="381.515625">Verify validity of B's Certificate</tspan></text><line x1="276.015625" x2="761.03125" y1="492" y2="492" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="287.015625" y="522" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="286.015625">Validity of certificate (True, if valid. False, otherwise)</tspan></text><line x1="761.03125" x2="276.015625" y1="528" y2="528" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="867.53125" y="558" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="866.53125">Verify validity of A's Certificate</tspan></text><line x1="1246.046875" x2="761.03125" y1="564" y2="564" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="772.03125" y="594" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="771.03125">Validity of certificate (True, if valid. False, otherwise)</tspan></text><line x1="761.03125" x2="1246.046875" y1="600" y2="600" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="22" y="620" width="234.015625" height="26" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="27" y="638" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="27">If certificate of B is valid</tspan></text></g><g class="note"><rect x="1266.046875" y="666" width="234.015625" height="26" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1271.046875" y="684" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1271.046875">If certificate of A is valid</tspan></text></g><g class="signal"><text x="637.5234375" y="722" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="636.5234375">Sends encrypted message "Hello"</tspan></text><line x1="276.015625" x2="1246.046875" y1="728" y2="728" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="signal"><text x="645.5234375" y="758" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="644.5234375">Sends encrypted message "ACK"</tspan></text><line x1="1246.046875" x2="276.015625" y1="764" y2="764" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g></svg>